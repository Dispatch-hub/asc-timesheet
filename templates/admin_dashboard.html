<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard - Alberta Safety</title>
</head>
<body style="background:#fff7e6; font-family:sans-serif;">
    <h1>Alberta Safety Timesheet – Admin</h1>
    <a href="{{ url_for('logout') }}">Logout</a> |
    <a href="{{ url_for('export_all') }}">Export All Timesheets</a>

    <h2>Add User</h2>
    <form action="{{ url_for('add_user') }}" method="POST">
        <input name="username" placeholder="Username" required>
        <input name="password" placeholder="Password" required>
        <select name="role">
            <option value="user">User</option>
            <option value="admin">Admin</option>
        </select>
        <button type="submit">Add</button>
    </form>

    <h2>Users</h2>
    <ul>
    {% for u, r in users %}
        <li>{{ u }} ({{ r }}) — <a href="{{ url_for('delete_user', username=u) }}">Delete</a> | <a href="{{ url_for('export_user', username=u) }}">Export</a></li>
    {% endfor %}
    </ul>

    <h2>Timesheets</h2>
    {% for user, records in timesheets.items() %}
        <h3>{{ user }}</h3>
        <table border="1" cellpadding="6">
            <tr><th>Date</th><th>Time</th><th>Hours</th><th>Description</th><th>Action</th></tr>
            {% for entry in records %}
            <tr>
                <td>{{ entry[2] }}</td>
                <td>{{ entry[3] }}</td>
                <td>{{ entry[4] }}</td>
                <td>{{ entry[5] }}</td>
                <td>
                    <a href="{{ url_for('edit_timesheet', entry_id=entry[0]) }}">Edit</a> |
                    <a href="{{ url_for('delete_timesheet', entry_id=entry[0]) }}">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </table>
    {% endfor %}
</body>
</html>
